#Oirat Misson Tree
#Made by Spirit

oir_missions_2 = {
	slot = 3
	generic = no
	ai = yes
	potential = {
		primary_culture = oirats
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	alliance_of_four_oirats = {
		icon = mission_unite_home_region
		required_missions = {  }
		position = 1
		ai_weight = {
			factor = 5
		}
		ai_priority = {
			factor = 5
		}
		trigger = {
			stability = 1
			army_size_percentage = 0.8
		}
		effect = {
			zungaria_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			north_zungaria = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	securing_zungaria = {
		icon = mission_unite_home_region
		required_missions = { alliance_of_four_oirats }
		#position = 1
		provinces_to_highlight = {
			OR = {
				area = zungaria_area
				area = north_zungaria
			}
			NOT = {
				owned_by = ROOT
				is_core = ROOT
			}
		}
		trigger = {
			zungaria_area = {
				is_core = ROOT
				type = all
			}
			north_zungaria = {
				is_core = ROOT
				type = all
			}
		}
		effect = {
			turpan_kumul_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			tarim_basin_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			shanshan_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			kashgaria_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	subjugate_yarkand = {
		icon = mission_unite_home_region
		required_missions = { securing_zungaria }
		#position = 1
		provinces_to_highlight = {
			OR = {
				area = turpan_kumul_area
				area = tarim_basin_area
				area = shanshan_area
				area = kashgaria_area 
			}
			NOT = {
				owned_by = ROOT
				is_core = ROOT
			}
		}
		trigger = {
			turpan_kumul_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
			tarim_basin_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
			shanshan_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
			kashgaria_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
		}
		effect = {
			add_prestige = 25
		}
	}
}

oir_missions_3 = {
	slot = 4
	generic = no
	ai = yes
	potential = {
		primary_culture = oirats
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	oirat_migration_to_dzungaria = {
		icon = mission_unite_home_region
		required_missions = { securing_zungaria }
		position = 3
		provinces_to_highlight = {
			area = zungaria_area
		}
		trigger = {
			zungaria_area = {
				type = all
				is_state_core = ROOT
				controlled_by = ROOT
			}
			is_at_war = no
		}
		effect = {
			2120 = {
				change_province_name = "Ghulja"
				move_capital_effect = yes
			}
			jetysuu_area = { 
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT 
			}
			balchasj_area = { 
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT 
			}
		}
	}
	integrate_local_elites = {
		icon = mission_unite_home_region
		required_missions = { oirat_migration_to_dzungaria }
		position = 3
		provinces_to_highlight = {
			area = zungaria_area
		}
		trigger = {
			zungaria_area = {
				type = all
				is_state_core = ROOT
				#controlled_by = ROOT
			}
			religion = vajrayana
			is_at_war = no
		}
		effect = {
			zungaria_area = {
				limit = {
					NOT = { culture = oirats }
				}
				change_culture = oirats
			}
		}
	}
	centralization = { # Growing power of Khong Tayiji
		icon = mission_unite_home_region
		required_missions = { integrate_local_elites }
		#position = 1
		provinces_to_highlight = {
		}
		trigger = {
			tag = ZUN
			zungaria_area = {
				type = all
				is_state_core = ROOT
			}
			north_zungaria = {
				is_state_core = ROOT
				type = all
			}
		}
		effect = {
			capital_scope = {
				add_base_tax = 2
				add_base_production = 2
				add_base_manpower = 2
				area = {
					limit = { owned_by = ROOT }
					add_province_modifier = {
						name = "growth_of_capital"
						duration = 9125 #25 years
					}
				}
			}
		}
	}
	last_nomad_empire = {
		icon = mission_unite_home_region
		required_missions = { centralization }
		#position = 1
		#provinces_to_highlight = {
		#}
		trigger = {
			OR = {
				any_rival_country = { 
					is_emperor_of_china = yes
				}
				any_known_country = {
					is_emperor_of_china = yes
					is_great_power = no
				}
			}
		}
		effect = {
			add_country_modifier = {
				name = "last_nomad_empire_m"
				duration = -1
			}
		}
	}
}

oir_missions_4 = {
	slot = 5
	generic = no
	ai = yes
	potential = {
		primary_culture = oirats
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	push_further_west = {
		icon = mission_unite_home_region
		required_missions = { securing_zungaria }
		position = 3
		provinces_to_highlight = {
			OR = {
				area = jetysuu_area
				area = balchasj_area
			}
			NOT = {
				owned_by = ROOT
				is_core = ROOT
			}
		}
		trigger = {
			jetysuu_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			balchasj_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_prestige = 25
		}
	}
	develop_local_source_of_iron = {
		icon = mission_unite_home_region
		required_missions = { integrate_local_elites }
		position = 5
		provinces_to_highlight = {
			province_id = 2120
		}
		trigger = {
			mil_tech = 11
			owns_core_province = 2120
			treasury = 500
		}
		effect = {
			2120 = {
				change_trade_goods = iron
			}
			add_treasury = -500
		}
	}
	gunsmith_manufactory = {
		icon = mission_unite_home_region
		required_missions = { develop_local_source_of_iron }
		#position = 7
		provinces_to_highlight = {
			province_id = 2120
		}
		trigger = {
			owns_core_province = 2120
			2120 = { has_building = weapons }
		}
		effect = {
			add_country_modifier = { 
				name = "dzungar_gunsmith_manufactory"
				duration = -1  
			}
		}
	}
}